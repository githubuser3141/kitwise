$.extend($,{log:function(){window.log=function(){if(window.CONSOLE_LOGGING){try{console.log.apply(console,arguments)}catch(a){if(window.CONSOLE_LOGGING==2){document.write("<script type='text/javascript' src='http://getfirebug.com/releases/lite/1.2/firebug-lite-compressed.js'><\/script>")}else{window.console={log:function(){return}}}}}};log("Console ready");return window.log}(),time:function(a){var b=(new Date()).getTime();return(a?b-a:b)},base:function(c,a){var b=$.fn[c]=$.extend(function(){var d=$.makeArray(arguments);if(typeof d[0]=="string"){b["public"][d[0]].apply(this,d.slice(1))}else{this.each(function(){return b.init.call($(this),d[0])})}return this},a);return b},cssBrowserSelect:(function(){var d=navigator.userAgent.toLowerCase(),f=function(b){return d.indexOf(b)!=-1},e=document.getElementsByTagName("html")[0],a=(!(/opera|webtv/i.test(d))&&/msie (\d)/.test(d))?("ie ie"+RegExp.$1):f("gecko/")?"gecko":f("opera/9")?"opera opera9":/opera (\d)/.test(d)?"opera opera"+RegExp.$1:f("konqueror")?"konqueror":f("applewebkit/")?"webkit safari":f("mozilla/")?"gecko":"",g=(f("x11")||f("linux"))?" linux":f("mac")?" mac":f("win")?" win":"",i=a+g+" js";e.className+=e.className?" "+i:i;return true})()});(function(){var a=Date.parse;Date.parse=function(b){var d=a(b),c=0,e;if(isNaN(d)&&(e=/(\d{4})-?(\d{2})-?(\d{2})(?:[T ](\d{2}):?(\d{2}):?(\d{2})(?:\.(\d{3,}))?(?:(Z)|([+\-])(\d{2})(?::?(\d{2}))?))/.exec(b))){if(e[8]!=="Z"){c=+e[10]*60+(+e[11]);if(e[9]==="+"){c=0-c}}d=Date.UTC(+e[1],+e[2]-1,+e[3],+e[4],+e[5]+c,+e[6],+e[7].substr(0,3))}return d}}());var classID="kitwise",fn=$.base(classID,{defaults:{trackerREGEXP:/<div class="blogger-post-footer"><img width='1' height='1' src='https:\/\/blogger\.googleusercontent\.com\/tracker[^']*' alt='' \/><\/div>/g,imgsrcREGEXP:/(<img[^<]*)(src="[^"]*")/gi,APIbaseURL:"http://www.blogger.com/feeds/5589880645096030234",featuredID:"5672995785452523292",aboutID:"2465165033397703116",contactID:"2706162495257255400",newsFeed:"/posts/default/-/news/",workFeed:"/posts/default/?alt=json-in-script&max-results=200",lineHeight:15,openSpd:500,closeSpd:500,itemMinWidth:240,firstFilter:"show"},months:["January","Februrary","March","April","May","June","July","August","September","October","November","December"],init:function(b){var d=$.extend(fn.defaults,{workData:[]},b),c=this,a=$("#subpage");this.data(classID,d);$("a.close").live("click",function(f,g){f.preventDefault();$(this).closest(".sub").addClass("isSlideRevealing").height(function(){return $(this).height()}).stop(true,true).animate({height:0,marginBottom:0},d.closeSpd,function(){$(this).empty().removeClass("open isSlideRevealing").removeAttr("style").hide().prev().removeClass("open");if(g){$(g).click()}})});$("#about-bt").click(function(f){f.preventDefault();if(a.hasClass("open")){$("#subpage a.close:first").trigger("click","#about-bt");return}$.ajax({dataType:"jsonp",url:d.APIbaseURL+"/pages/default/"+d.aboutID+"?alt=json-in-script",success:function(e){$content=fn.view.about.call(c,e);fn.openSubpage.call(c,a,$("<h2>"+e.entry.title.$t+"</h2>").add($content))}})});$("#contact-bt").click(function(f){f.preventDefault();if(a.hasClass("open")){$("#subpage a.close:first").trigger("click","#contact-bt");return}$.ajax({dataType:"jsonp",url:d.APIbaseURL+"/pages/default/"+d.contactID+"?alt=json-in-script",success:function(g){var e=$('<div class="contact entry"/>').append(g.entry.content.$t.replace(fn.defaults.trackerREGEXP,""));fn.openSubpage.call(c,a,$("<h2>"+g.entry.title.$t+"</h2>").add(e))}})});$("#news-bt").click(function(f){f.preventDefault();if(a.hasClass("open")){$("#subpage a.close:first").trigger("click","#news-bt");return}$.ajax({dataType:"jsonp",url:d.APIbaseURL+d.newsFeed+"?alt=json-in-script",success:function(e){$content=fn.view.news.call(c,e);fn.openSubpage.call(c,a,$("<h2>News</h2>").add($content))}})});$("#works-bt").click(function(f){f.preventDefault();$("html,body").stop(true).animate({scrollTop:$("#works-nav").offset().top},500)});$(".totop").click(function(f){f.preventDefault();$("html,body").stop(true).animate({scrollTop:0},500)});$.ajax({dataType:"jsonp",url:d.APIbaseURL+"/pages/default/"+d.featuredID+"?alt=json-in-script",success:function(f){var e=f.entry.content.$t.replace(fn.defaults.trackerREGEXP,"");$("#featured").append($(e).not(".blogger-post-footer")).hide().fadeIn()},error:function(f){}});$.ajax({dataType:"jsonp",url:d.APIbaseURL+d.workFeed,success:function(g){var i=$.time(),f=fn.defaults.lineHeight;$.each(g.feed.entry,function(e,j){if(!this.category.length||this.category[0].term=="news"){return true}else{if(this.category[0].term!=fn.defaults.firstFilter){$('<a class="dummy item '+this.category[0].term+'" id="work-'+e+'"/>').appendTo("#works");d.workData["work-"+e]=j;return true}}fn.view.work.call(c,j)});try{$("#filter-"+fn.defaults.firstFilter).trigger("click",true)}catch(h){}log("Work setup took ",$.time(i))},error:function(f){}});$("#filter-show, #filter-bibliography, #filter-writing").bind("click",function(j,h){j.preventDefault();var i=$(this),f=i.attr("rel"),g=i.hasClass("open");$("#works-nav a").not(i).removeClass("open").removeAttr("title");i.toggleClass("open").attr("title","Click to remove filter");if(!g){if(!h){$("#works a.item:visible:not(."+f+")").stop(true,true).animate({marginRight:0,width:0},"def",function(){$(this).hide()})}else{$("#works a.item:not(."+f+")").stop(true,true).css({marginRight:0,width:0}).hide()}}$("#works a.item:hidden"+(!g?"."+f:"")).each(function(){var e=$(this);if(e.hasClass("dummy")){e.replaceWith(fn.view.work.call(c,d.workData[e.attr("id")]))}e.stop(true,true).show().animate({marginRight:14,width:e.attr("data-width")})});$("#workpage.open .close:first").click()});$(".mediaViewer a.next, .mediaViewer a.prev").live("click",function(i){i.preventDefault();var g=$(this).hasClass("next"),j=$(".mediaViewer .p:visible").hide(),h=g?j.next(".p"):j.prev(".p"),f=h.length?h:$(".mediaViewer .p:"+(g?"first":"last"));$(".mediaViewer .nav .index").text($(".mediaViewer .p").index(f)+1);f.stop(true,true).fadeIn()});$(".mediaViewer .p img").live("click",function(f){f.preventDefault();f.stopPropagation();$(".mediaViewer a.next").click()})},openSubpage:function(a,b){var c=a.show().append('<a class="close top" href="#">Close</a>',b,'<a class="close bottom" href="#">Close</a>').addClass("open").height();a.addClass("isSlideRevealing").height(0).animate({height:c,marginBottom:36},fn.defaults.openSpd,function(){a.removeClass("isSlideRevealing").css("height","")})},openWork:function(c){c.preventDefault();var b=$(c.currentTarget),a=$("#workpage");if(b.hasClass("open")||a.hasClass("isSlideRevealing")){return}$("html,body").stop(true).animate({scrollTop:b.offset().top+b.height()},500);if(a.hasClass("open")){$("#workpage a.close:first").trigger("click",b);return}b.addClass("open");if(!b.hasClass("parsed")){b.data("itemData",fn.view.workContent.call(this,b.addClass("parsed")))}fn.openSubpage.call(this,a.insertAfter(b),b.data("itemData"))}});fn.helper={resizeBloggerImage:function(b,a){b=b||"";b=b.split("/");b[b.length-2]=a;return b.join("/")},splitColumns:function(f,d,b,a){var c=d.height()/2,e=0;f.each(function(g){var h=$(this);if(e>c){f.slice(g+(a?1:0)).appendTo(b);return false}e+=h.outerHeight(true)})}};fn.view={about:function(e){var c=$('<div class="about entry"/>').append(e.entry.content.$t.replace(fn.defaults.trackerREGEXP,"")).appendTo("body"),b=$([]).add($.map(c.html().split(/(<br>){2,}/gi),function(f){return f&&f!="<br>"?$('<div class="p">'+f+"</div>")[0]:null})),d=$('<div class="col1"></col>').appendTo(c.empty()).append(b),a=$('<div class="col2"></col>').appendTo(c);$('<span class="dot"></span>').appendTo(b.last());fn.helper.splitColumns.call(this,b,d,a);return c},news:function(d){var e=$([]);$.each(d.feed.entry,function(h){var g=this.content.$t.replace(fn.defaults.trackerREGEXP,""),f=new Date(Date.parse(this.published.$t)),j=f.getDate()+" "+fn.months[f.getMonth()]+" "+f.getFullYear();e=e.add($("<p/>").append("<strong>"+this.title.$t+"</strong>","<br/>",$("<div>"+g+"</div>"),"<em>"+j+"</em>"))});var b=$('<div class="news entry"/>').appendTo("body"),c=$('<div class="col1"></col>').appendTo(b).html(e),a=$('<div class="col2"></col>').appendTo(b);fn.helper.splitColumns.call(this,$("p",b),c,a,true);return b},work:function(r){var h=this,m=r.content.$t.replace(fn.defaults.trackerREGEXP,"").replace(fn.defaults.imgsrcREGEXP,"$1data-$2"),q=new Date(Date.parse(r.published.$t)),o=fn.months[q.getMonth()]+" "+q.getFullYear(),e=r.category?r.category[0].term:"",j=e!="writing"?"<em>"+o+"</em>":"",b=$('<div class="entry">'+m+"</div>"),i=$("img:first",b).clone().attr("src",function(s,t){return fn.helper.resizeBloggerImage($(this).attr("data-src"),"h150")}).removeAttr("style"),f=i.length,a=$("b:first-child",b).remove(),g=a.is("b")||e=="show"?"subtitle":"",d=$("<strong>"+(f?r.title.$t:a.text())+"</strong>"),c=$("<h2>"+r.title.$t+"</h2>"),n=$('<a href="#" class="item '+e+'"/>').append(i.length?$("<span/>").append(i):c,d,j).data("itemData",{title:c.clone().addClass(g),subtitle:a.clone().addClass(g),date:j,content:b}).bind("click",$.proxy(fn.openWork,h)).appendTo("#works");if(!f){c.width(fn.defaults.itemMinWidth);while(c.height()>84){c.width(function(t,s){return s+40})}if(c.width()<fn.defaults.itemMinWidth){c.width(fn.defaults.itemMinWidth)}c.height(140);var k=c.outerWidth();n.width(k).attr("data-width",k)}else{i.load(function(){if(!n.is(":visible")){n.show().css({width:""}).attr("data-width",n.width()).width(0).hide()}else{n.attr("data-width",n.width())}})}var l=fn.defaults.lineHeight;if(d.height()>l){n.addClass("shortened")}if(d.height()>l*2){n.attr("title",d.text());d.text(function(t,s){return s+"..."}).next().remove();var p=0;while(d.height()>l*2&&p++<100){d.text(function(t,s){return s.slice(0,-4)+"..."})}}return n},workContent:function(d){var f=d.data("itemData"),a=f.content.appendTo("body");$("div.separator",a).replaceWith(function(){return $(this).html()});$("a",a).attr("target","_blank");var b=a.html().split(/(<br>){2,}/gi),h=$([]).add($.map(b,function(j){return j&&j!="<br>"?$('<div class="p">'+j+"</div>")[0]:null})),c=$([]),i=null;h=h.map(function(){var j=$(this);if(j.is(".p:has(img,object)")){j.find("img").attr("src",function(k,l){return fn.helper.resizeBloggerImage($(this).attr("data-src"),"h500")}).removeAttr("style");$("a[imageanchor]",this).replaceWith(function(){return $(this).html()});c=c.add(this);return null}return this});if(c.length){i=$('<div class="mediaViewer '+(c.length>1?' hasNav" ><div class="nav"><em>Image <span class="index">1</span>/'+c.length+'</em><br/><a class="prev" href="#">Prior</a> / <a class="next" href="#">Next</a></div></div>':'" >')).append(c);c.slice(1).hide()}$('<span class="dot" />').appendTo(h.last());a.empty().append(f.title,f.subtitle.length?f.subtitle.append(f.date):$(f.date).addClass("subtitle"),i);var g=$('<div class="col1" />').appendTo(a).append(h),e=$('<div class="col2" />').appendTo(a);fn.helper.splitColumns(h,g,e);return a}};